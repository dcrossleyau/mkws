# Configuration for the apache web server
# Running on caliban

<VirtualHost *:80>
    ServerName mkws.indexdata.com

    ErrorLog /var/log/apache2/mkws-error.log
    CustomLog /var/log/apache2/mkws-access.log combined

    DocumentRoot /home/indexdata/mkws/experiments/spclient/
    Alias /libjs-pz2/ /home/indexdata/libjs-pz2/
    Alias /index.html /home/indexdata/mkws/experiments/spclient/index-mkws.html

    RewriteEngine on
    RewriteLogLevel 1
    RewriteLog /var/log/apache2/mkws-rewrite.log 
    RewriteRule /service-proxy-auth /service-proxy/?command=auth&action=login&username=guest&password=guest [P] # [NE,P]
    RewriteRule /service-proxy/auth /service-proxy/?command=auth&action=login&username=guest&password=guest [P] # [NE,P]

    Header set Access-Control-Allow-Origin "http://somesite.indexdata.com"
    Header set Access-Control-Allow-Credentials true

    # For MKC Service Proxy
    ProxyPass        /service-proxy/ http://mkc.indexdata.com:9009/service-proxy/
    ProxyPassReverse /service-proxy/ http://mkc.indexdata.com:9009/service-proxy/
    ProxyPassReverseCookiePath /service-proxy /
    ProxyPassReverseCookieDomain "" mkws.indexdata.com
</VirtualHost>

<VirtualHost *:80>
    ServerName somesite.indexdata.com

    ErrorLog /var/log/apache2/somesite-error.log
    CustomLog /var/log/apache2/somesite-access.log combined

    DocumentRoot /home/indexdata/mkws/experiments/spclient/
    Alias /index.html /home/indexdata/mkws/experiments/spclient/index-somesite.html

    RewriteEngine on
    RewriteLogLevel 1
    RewriteLog /var/log/apache2/mkws-rewrite.log 
    RewriteRule /service-proxy-auth /service-proxy/?command=auth&action=login&username=guest&password=guest [P] # [NE,P]

    # For MKC Service Proxy
    ProxyPass        /service-proxy/ http://mkc.indexdata.com:9009/service-proxy/
    ProxyPassReverse /service-proxy/ http://mkc.indexdata.com:9009/service-proxy/
</VirtualHost>
